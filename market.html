<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†—ã–Ω–æ–∫ Binance ‚Äî –°–ø–æ—Ç</title>
  <link rel="stylesheet" href="style.css">
  <style>
    main {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .market-container {
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: #f1f1f1;
      cursor: pointer;
    }

    th, td {
      padding: 12px;
      text-align: left;
      font-size: 14px;
    }

    tbody tr:nth-child(even) {
      background: #f9f9f9;
    }

    .green {
      color: #16a34a;
      font-weight: bold;
    }

    .red {
      color: #dc2626;
      font-weight: bold;
    }

    .trade-btn {
      background: #fcd535;
      color: #000;
      padding: 6px 10px;
      border-radius: 4px;
      text-decoration: none;
      font-weight: 600;
    }

    .trade-btn:hover {
      background: #e0bb2f;
    }

    th.sortable:hover {
      background: #e9e9e9;
    }

    th.active-sort {
      background: #e0e0e0;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div id="header"></div>
  <div id="sidebar"></div>

  <main>
    <h1>üìä –†—ã–Ω–æ–∫ Binance ‚Äî –í—Å–µ –º–æ–Ω–µ—Ç—ã (Spot)</h1>
    <div class="market-container">
      <table>
        <thead>
          <tr>
            <th>–ú–æ–Ω–µ—Ç–∞</th>
            <th class="sortable" data-sort="price">–¶–µ–Ω–∞ ‚ñ≤‚ñº</th>
            <th class="sortable" data-sort="change">–ò–∑–º. 24—á ‚ñ≤‚ñº</th>
            <th class="sortable" data-sort="volume">–û–±—ä—ë–º ‚ñ≤‚ñº</th>
            <th>–¢–æ—Ä–≥–æ–≤–∞—Ç—å</th>
          </tr>
        </thead>
        <tbody id="market-body">
          <tr><td colspan="5" style="text-align:center;padding:20px;">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
        </tbody>
      </table>
    </div>

<div style="text-align:center; margin:32px 0;">
  <a href="https://www.binance.com/ru?ref=SITES" target="_blank" rel="noopener noreferrer">
    <img src="binance.jpg" alt="Binance" width="1200" height="675" style="border:0; display:inline-block;">
  </a>
</div>

  </main>

  <script>
    // –ó–∞–≥—Ä—É–∂–∞–µ–º header –∏ sidebar
    fetch('header.html')
      .then(res => res.text())
      .then(data => document.getElementById('header').innerHTML = data);

    fetch('sidebar.html')
      .then(res => res.text())
      .then(data => document.getElementById('sidebar').innerHTML = data);

    const REF_ID = 'SITES'; // —Ç–≤–æ–π —Ä–µ—Ñ-–∫–æ–¥ Binance
    let marketData = [];
    let currentSort = { key: 'volume', asc: false };

    const API_URL = 'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=volume_desc&per_page=100&page=1&sparkline=false';

    async function loadMarketData() {
      try {
        const response = await fetch(API_URL);
        const data = await response.json();

        marketData = data.map(item => ({
          id: item.id,
          symbol: item.symbol.toUpperCase(),
          name: item.name,
          price: item.current_price,
          change: item.price_change_percentage_24h,
          volume: item.total_volume
        }));

        renderTable();
      } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö CoinGecko:', e);
        const tbody = document.getElementById('market-body');
        tbody.innerHTML = `<tr><td colspan="5" style="text-align:center;color:red;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö.</td></tr>`;
      }
    }

    function renderTable() {
      const tbody = document.getElementById('market-body');
      tbody.innerHTML = '';

      const sorted = [...marketData].sort((a, b) => {
        const key = currentSort.key;
        const dir = currentSort.asc ? 1 : -1;
        return a[key] > b[key] ? dir : a[key] < b[key] ? -dir : 0;
      });

      sorted.forEach(item => {
        const changeClass = item.change >= 0 ? 'green' : 'red';
        const tradeUrl = `https://www.binance.com/ru/trade/${item.symbol}_USDT?ref=${REF_ID}`;

        const row = `
          <tr>
            <td>${item.name} (${item.symbol})</td>
            <td>$${item.price.toFixed(6)}</td>
            <td class="${changeClass}">${item.change?.toFixed(2) ?? 0}%</td>
            <td>$${Number(item.volume).toLocaleString()}</td>
            <td><a class="trade-btn" href="${tradeUrl}" target="_blank">–¢–æ—Ä–≥–æ–≤–∞—Ç—å</a></td>
          </tr>
        `;
        tbody.insertAdjacentHTML('beforeend', row);
      });

      updateActiveSortHeader();
    }

    function updateActiveSortHeader() {
      document.querySelectorAll('th.sortable').forEach(th => {
        th.classList.remove('active-sort');
        if (th.dataset.sort === currentSort.key) {
          th.classList.add('active-sort');
        }
      });
    }

    document.querySelectorAll('th.sortable').forEach(th => {
      th.addEventListener('click', () => {
        const sortKey = th.dataset.sort;
        if (currentSort.key === sortKey) {
          currentSort.asc = !currentSort.asc;
        } else {
          currentSort.key = sortKey;
          currentSort.asc = false;
        }
        renderTable();
      });
    });

    loadMarketData();
    setInterval(loadMarketData, 60000);
  </script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EEZSLT2L6C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-KH63Z4DFJ2');
  </script>
</body>
</html>
